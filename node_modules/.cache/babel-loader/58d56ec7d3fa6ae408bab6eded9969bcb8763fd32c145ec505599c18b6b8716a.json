{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getCurrentScope } from 'vue';\nimport { auth, database } from '../firebaseConfig';\nimport { ref, get } from 'firebase/database';\n// import { useStore } from 'vuex'\nimport { useRouter } from 'vue-router';\n// import { useDatabaseList } from 'vuefire'\n\n// const foodEvents = useDatabaseList(ref(database, \"foodEvent\"));\n// const crowdfunding = useDatabaseList(ref(database, \"crowdfundingEvent\"));\n// console.log(foodEvents)\n\nconst __default__ = {\n  data() {\n    return {\n      userRole: null,\n      // store: useStore(),\n      router: useRouter(),\n      currentTime: new Date().getTime()\n      // firebaseFoodEvents: foodEvents,\n      // firebaseCrowdfundEvents: crowdfunding,\n    };\n  },\n  mounted() {\n    this.fetchUserRole();\n  },\n  computed: {\n    isUser() {\n      return this.userRole === 'user';\n    },\n    isAdmin() {\n      return this.userRole === 'admin';\n    }\n  },\n  methods: {\n    fetchUserRole() {\n      auth.onAuthStateChanged(user => {\n        if (user && user.uid) {\n          // Null check added here\n          const userRef = ref(database, `users/${user.uid}/role`);\n          get(userRef).then(snapshot => {\n            this.userRole = snapshot.val();\n            console.log(\"User Role from Database:\", this.userRole);\n          }).catch(error => {\n            console.error(\"Error fetching user role:\", error);\n          });\n        } else {\n          // Handle the case where the user or user.uid is null\n          console.log(\"User or user UID is null\");\n        }\n      });\n    }\n  },\n  async signOut() {\n    await this.store.dispatch('logoutUser');\n    this.router.push('/');\n  }\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  __name: 'AppHeader',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    console.log(getCurrentScope());\n    const __returned__ = {\n      get auth() {\n        return auth;\n      },\n      get database() {\n        return database;\n      },\n      get ref() {\n        return ref;\n      },\n      get get() {\n        return get;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      getCurrentScope\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n});","map":{"version":3,"names":["getCurrentScope","auth","database","ref","get","useRouter","__default__","data","userRole","router","currentTime","Date","getTime","mounted","fetchUserRole","computed","isUser","isAdmin","methods","onAuthStateChanged","user","uid","userRef","then","snapshot","val","console","log","catch","error","signOut","store","dispatch","push"],"sources":["/Users/junyi/Documents/petadopt/src/components/AppHeader.vue"],"sourcesContent":["<script setup>\nimport { getCurrentScope} from 'vue'\n\nconsole.log(getCurrentScope())\n\n\n</script>\n\n<template>\n    <router-link v-if=\"isUser\" to=\"/dashboard\"></router-link>\n    <router-link v-else to=\"/auth/login\"></router-link>\n\n\n</template>\n\n\n\n<script>\nimport { auth, database } from '../firebaseConfig';\nimport { ref, get } from 'firebase/database';\n// import { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\n// import { useDatabaseList } from 'vuefire'\n\n\n// const foodEvents = useDatabaseList(ref(database, \"foodEvent\"));\n// const crowdfunding = useDatabaseList(ref(database, \"crowdfundingEvent\"));\n// console.log(foodEvents)\n\nexport default {\n  data() {\n    return {\n      userRole: null,\n      // store: useStore(),\n      router: useRouter(),\n\n      currentTime: new Date().getTime(),\n      // firebaseFoodEvents: foodEvents,\n      // firebaseCrowdfundEvents: crowdfunding,\n    };\n  },\n  mounted() {\n    this.fetchUserRole();\n \n  },\n  computed: {\n    isUser() {\n      return this.userRole === 'user';\n    },\n    isAdmin() {\n      return this.userRole === 'admin';\n    },\n   \n  },\n  methods: {\n    fetchUserRole() {\n    auth.onAuthStateChanged((user) => {\n      if (user && user.uid) { // Null check added here\n        const userRef = ref(database, `users/${user.uid}/role`);\n        get(userRef)\n          .then((snapshot) => {\n            this.userRole = snapshot.val();\n            console.log(\"User Role from Database:\", this.userRole);\n          })\n          .catch((error) => {\n            console.error(\"Error fetching user role:\", error);\n          });\n      } else {\n        // Handle the case where the user or user.uid is null\n        console.log(\"User or user UID is null\");\n      }\n  });\n},\n\n  },\n    async signOut() {\n      await this.store.dispatch('logoutUser');\n      this.router.push('/');\n    },\n  };\n</script>\n\n\n"],"mappings":";AACA,SAASA,eAAe,QAAO,KAAK;AAiBpC,SAASC,IAAI,EAAEC,QAAQ,QAAQ,mBAAmB;AAClD,SAASC,GAAG,EAAEC,GAAG,QAAQ,mBAAmB;AAC5C;AACA,SAASC,SAAS,QAAQ,YAAY;AACtC;;AAGA;AACA;AACA;;AAEA,MAAAC,WAAA,GAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,IAAI;MACd;MACAC,MAAM,EAAEJ,SAAS,CAAC,CAAC;MAEnBK,WAAW,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC;MAChC;MACA;IACF,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,aAAa,CAAC,CAAC;EAEtB,CAAC;EACDC,QAAQ,EAAE;IACRC,MAAMA,CAAA,EAAG;MACP,OAAO,IAAI,CAACR,QAAQ,KAAK,MAAM;IACjC,CAAC;IACDS,OAAOA,CAAA,EAAG;MACR,OAAO,IAAI,CAACT,QAAQ,KAAK,OAAO;IAClC;EAEF,CAAC;EACDU,OAAO,EAAE;IACPJ,aAAaA,CAAA,EAAG;MAChBb,IAAI,CAACkB,kBAAkB,CAAEC,IAAI,IAAK;QAChC,IAAIA,IAAI,IAAIA,IAAI,CAACC,GAAG,EAAE;UAAE;UACtB,MAAMC,OAAO,GAAGnB,GAAG,CAACD,QAAQ,EAAG,SAAQkB,IAAI,CAACC,GAAI,OAAM,CAAC;UACvDjB,GAAG,CAACkB,OAAO,CAAC,CACTC,IAAI,CAAEC,QAAQ,IAAK;YAClB,IAAI,CAAChB,QAAQ,GAAGgB,QAAQ,CAACC,GAAG,CAAC,CAAC;YAC9BC,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAACnB,QAAQ,CAAC;UACxD,CAAC,CAAC,CACDoB,KAAK,CAAEC,KAAK,IAAK;YAChBH,OAAO,CAACG,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;UACnD,CAAC,CAAC;QACN,CAAC,MAAM;UACL;UACAH,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;QACzC;MACJ,CAAC,CAAC;IACJ;EAEE,CAAC;EACC,MAAMG,OAAOA,CAAA,EAAG;IACd,MAAM,IAAI,CAACC,KAAK,CAACC,QAAQ,CAAC,YAAY,CAAC;IACvC,IAAI,CAACvB,MAAM,CAACwB,IAAI,CAAC,GAAG,CAAC;EACvB;AACF,CAAC;;;;;;;IA5EHP,OAAO,CAACC,GAAG,CAAC3B,eAAe,CAAC,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}