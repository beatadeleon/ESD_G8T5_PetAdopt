{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getCurrentScope } from 'vue';\nimport { auth, database } from '../firebaseConfig';\nimport { ref, get } from 'firebase/database';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n// import { useDatabaseList } from 'vuefire'\n\n// const foodEvents = useDatabaseList(ref(database, \"foodEvent\"));\n// const crowdfunding = useDatabaseList(ref(database, \"crowdfundingEvent\"));\n// console.log(foodEvents)\n\nconst __default__ = {\n  data() {\n    return {\n      isDropdownOpen: false,\n      userRole: null,\n      store: useStore(),\n      router: useRouter(),\n      isNotificationsOpen: false,\n      currentTime: new Date().getTime(),\n      // firebaseFoodEvents: foodEvents,\n      // firebaseCrowdfundEvents: crowdfunding,\n      activeFoodEventsCount: 0,\n      activeCrowdfundCount: 0\n    };\n  },\n  mounted() {\n    this.fetchUserRole();\n    this.calculateActiveEvents();\n    this.calculateCrowdfundActiveEvents();\n  },\n  computed: {\n    isUser() {\n      return this.userRole === 'user';\n    },\n    isFoodBank() {\n      return this.userRole === 'foodBank';\n    },\n    isDeliveryDriver() {\n      return this.userRole === 'driver';\n    }\n  },\n  fetchUserRole() {\n    auth.onAuthStateChanged(user => {\n      const userRef = ref(database, `users/${user.uid}/role`);\n      get(userRef).then(snapshot => {\n        this.userRole = snapshot.val();\n        //console.log(\"User Role from Database:\", this.userRole);\n      }).catch(error => {\n        console.error(\"Error fetching user role:\", error);\n      });\n    });\n  },\n  async signOut() {\n    await this.store.dispatch('logoutUser');\n    this.router.push('/');\n  }\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  __name: 'AppHeader',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    console.log(getCurrentScope());\n\n    //console.log(foodEvents) \n\n    const __returned__ = {\n      get auth() {\n        return auth;\n      },\n      get database() {\n        return database;\n      },\n      get ref() {\n        return ref;\n      },\n      get get() {\n        return get;\n      },\n      get useStore() {\n        return useStore;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      getCurrentScope\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n});","map":{"version":3,"names":["getCurrentScope","auth","database","ref","get","useStore","useRouter","__default__","data","isDropdownOpen","userRole","store","router","isNotificationsOpen","currentTime","Date","getTime","activeFoodEventsCount","activeCrowdfundCount","mounted","fetchUserRole","calculateActiveEvents","calculateCrowdfundActiveEvents","computed","isUser","isFoodBank","isDeliveryDriver","onAuthStateChanged","user","userRef","uid","then","snapshot","val","catch","error","console","signOut","dispatch","push","log"],"sources":["/Users/junyi/Documents/petadopt/src/components/AppHeader.vue"],"sourcesContent":["<script setup>\nimport { getCurrentScope} from 'vue'\n\nconsole.log(getCurrentScope())\n\n//console.log(foodEvents) \n</script>\n\n<template>\n\n  <!-- <div>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css\">\n    <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\">\n    <nav class=\"navbar navbar-expand-md navbar-light nav-colour\">\n      <div class=\"container-fluid\">\n        <a class=\"navbar-brand d-none d-md-block\" href=\"/\" style=\"padding: 0; margin: 0; width:40%;\">\n         \n        </a>\n\n        <a class=\"navbar-brand d-block d-md-none\" href=\"/\"/>\n\n        <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarSupportedContent\"\n          aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n          <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n          <ul class=\"navbar-nav me-auto mb-4 mb-lg-0\" style=\"margin-top: 20px; margin-right: 30%\">\n\n            <li v-if=\"isFoodBank\" class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                Crowd Fund\n              </a>\n              <ul class=\"dropdown-menu\">\n                <li><a class=\"dropdown-item\" href=\"/crowdfunding/creation\">Create Crowdfunding Events</a></li>\n              </ul>\n            </li>\n            <li v-else-if=\"isUser\" class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                Crowd Fund\n              </a>\n              <ul class=\"dropdown-menu\">\n                <li><a class=\"dropdown-item\" href=\"/crowdfunding\">Find Crowdfunding Events</a></li>\n              </ul>\n            </li>\n            <li v-else-if=\"isDeliveryDriver\" class=\"nav-item\">\n              \n            </li>\n            <li v-else class=\"nav-item\">\n              <a class=\"nav-link\" href=\"/auth/login\">Crowd Fund</a>\n            </li>\n\n            <li v-if=\"isFoodBank\" class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                Food Events\n              </a>\n              <ul class=\"dropdown-menu\">\n                <li><a class=\"dropdown-item\" href=\"/foodeve/creation\">Create Food Events</a></li>\n                <li><a class=\"dropdown-item\" href=\"/foodeve/approve\">Approve Food Donations</a></li>\n                <li><a class=\"dropdown-item\" href=\"/foodbank/delivery/create\">Add Delivery Driver</a></li>\n              </ul>\n            </li>\n            <li v-else-if=\"isUser\" class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                Food Events\n              </a>\n              <ul class=\"dropdown-menu\">\n                <li><a class=\"dropdown-item\" href=\"/foodeve/trending\">Trending food events</a></li>\n                <li><a class=\"dropdown-item\" href=\"/foodeve/groupDonations/approve\">My Group Donations</a></li>\n                <li><a class=\"dropdown-item\" href=\"/search\">Find Us</a></li>\n              </ul>\n            </li>\n            <li v-else-if=\"isDeliveryDriver\" class=\"nav-item\">\n              \n            </li>\n            <li v-else class=\"nav-item dropdown\">\n              <a class=\"nav-link dropdown-toggle\" href=\"#\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                Food Events\n              </a>\n              <ul class=\"dropdown-menu\">\n                <li><a class=\"dropdown-item\" href=\"/auth/login\">Trending food events</a></li>\n                <li><a class=\"dropdown-item\" href=\"/auth/login\">Find Us</a></li>\n              </ul>\n            </li>\n\n\n              <li v-if=\"isDeliveryDriver || isFoodBank\"></li>\n              <li v-else class=\"nav-item\">\n                <a class=\"nav-link\" href=\"/aboutUs\">About Us</a>\n              </li>\n            </ul>\n          <div class=\"dropdown d-flex justify-content-end\">\n            <div class=\"navbar-nav me-auto mb-3 mb-lg-0\">\n\n              <div class=\"d-flex justify-content-end\">\n                  <li v-if=\"isUser\" class=\"nav-item dropdown mr-3\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"currentColor\"\n                      class=\"bi bi-bell-fill g-5 dropdown-toggle\" data-bs-toggle=\"dropdown\" data-bs-auto-close=\"outside\"\n                      aria-expanded=\"false\" viewBox=\"0 0 16 16\">\n                      <path\n                        d=\"M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zm.995-14.901a1 1 0 1 0-1.99 0A5.002 5.002 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901z\" />\n                    </svg>\n                    <ul class=\"dropdown-menu dropdown-menu-end dropdown-notif \" v-if=\"isUser\" :class=\"{ show: isNotificationsOpen }\">\n                      <li>\n                        <div class=\"btn-group d-flex\" role=\"group\" style=\"text-align: center;\">\n                          <button class=\"btn btn-light\" @click=\"showFoodEventsTab\">Food Events</button>\n                          <button class=\"btn btn-light\" @click=\"showCrowdfundingEventsTab\">Crowdfunding Events</button>\n                        </div>\n                      </li>\n\n                      <div v-if=\"showFoodEvents\" class=\"row\">\n                        Food Events content \n                          <li v-for=\"(foodEvent, index) in foodEvents\" :key=\"index\" >\n                            <div class=\"dropdown-item content-section\" v-if=\"new Date(foodEvent.endEventDate).getTime() >= currentTime\">\n                              <a :href=\"'/foodeve/' + foodEvent.id\" class=\"text-truncate d-block\">\n                                {{ foodEvent.eventName }}\n                              </a>\n                              <div class=\"event-description mt-1\">{{ foodEvent.eventDescription }}</div>\n                              <small class=\"text-muted d-block mt-1\">\n                                Ends: {{ new Date(foodEvent.endEventDate).toLocaleDateString() }}\n                              </small>\n                            </div>\n                            <div class=\"dropdown-divider\" v-if=\"index !== foodEvents.length - 1\"></div>\n                          </li>\n                        </div>\n                        <div v-if=\"showCrowdfundingEvents\" class=\"row\">\n                         Crowdfunding Events content \n                          <li v-for=\"(crowdfundingEvent, index) in crowdfunding\" :key=\"index\" >\n                            <div class=\"dropdown-item content-section\" v-if=\"new Date(crowdfundingEvent.endEventDate).getTime() >= currentTime\">\n                              <a :href=\"'/crowdfunding/' + crowdfundingEvent.id\" class=\"text-truncate d-block\">\n                                {{ crowdfundingEvent.eventName }}\n                              </a>\n                              <div class=\"event-description mt-1 ellipsis\">{{ crowdfundingEvent.eventDescription }}</div>\n                              <small class=\"text-muted d-block mt-1\">\n                                Ends: {{ new Date(crowdfundingEvent.endEventDate).toLocaleDateString() }}\n                              </small>\n                            </div>\n                            <div class=\"dropdown-divider\" v-if=\"index !== crowdfunding.length - 1\"></div>\n                          </li>\n                        </div>\n                    </ul> \n                  </li>\n                  <li v-else></li>\n           \n\n           \n      \n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </nav>\n  </div> -->\n\n</template>\n\n<style scoped>\n\n.ellipsis {\n  white-space: nowrap;      /* Prevents the text from wrapping */\n  overflow: hidden;         /* Hides any overflow that doesn't fit in the container */\n  text-overflow: ellipsis;  /* Renders an ellipsis (...) to represent the clipped text */\n  width: 100%;              /* You can adjust the width as necessary */\n  display: block;           /* Or inline-block, depending on your layout */\n}\n\n.logo-small {\n  width: 30%;\n  height: 30%;\n}\n\n.logo-large {\n  width: 35%;\n  height: 35%;\n}\n\n.navbar-brand {\n  margin: 0;\n  padding: 0;\n  width: 40%;\n}\n\ni {\n  width: 60px;\n  height: 60px;\n}\n\n\n\n.dropdown-menu {\n  overflow: hidden;\n  overflow-y: auto;\n  max-height: 300px;\n}\n\n.content-section {\n  max-width: 350px;\n  /* Adjust the width as per your requirements */\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n</style>\n\n<script>\nimport { auth, database } from '../firebaseConfig';\nimport { ref, get } from 'firebase/database';\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\n// import { useDatabaseList } from 'vuefire'\n\n\n// const foodEvents = useDatabaseList(ref(database, \"foodEvent\"));\n// const crowdfunding = useDatabaseList(ref(database, \"crowdfundingEvent\"));\n// console.log(foodEvents)\n\nexport default {\n  data() {\n    return {\n      isDropdownOpen: false,\n      userRole: null,\n      store: useStore(),\n      router: useRouter(),\n      isNotificationsOpen: false,\n      currentTime: new Date().getTime(),\n      // firebaseFoodEvents: foodEvents,\n      // firebaseCrowdfundEvents: crowdfunding,\n      activeFoodEventsCount: 0,\n      activeCrowdfundCount: 0,\n    };\n  },\n  mounted() {\n    this.fetchUserRole();\n    this.calculateActiveEvents();\n    this.calculateCrowdfundActiveEvents();\n  },\n  computed: {\n    isUser() {\n      return this.userRole === 'user';\n    },\n    isFoodBank() {\n      return this.userRole === 'foodBank';\n    },\n    isDeliveryDriver() {\n      return this.userRole === 'driver';\n    }\n  },\n\n    fetchUserRole() {\n      auth.onAuthStateChanged((user) => {\n        const userRef = ref(database, `users/${user.uid}/role`);\n        get(userRef)\n          .then((snapshot) => {\n            this.userRole = snapshot.val();\n            //console.log(\"User Role from Database:\", this.userRole);\n          })\n          .catch((error) => {\n            console.error(\"Error fetching user role:\", error);\n          });\n      });\n    },\n    async signOut() {\n      await this.store.dispatch('logoutUser');\n      this.router.push('/');\n    },\n  };\n</script>\n\n\n"],"mappings":";AACA,SAASA,eAAe,QAAO,KAAK;AA6MpC,SAASC,IAAI,EAAEC,QAAQ,QAAQ,mBAAmB;AAClD,SAASC,GAAG,EAAEC,GAAG,QAAQ,mBAAmB;AAC5C,SAASC,QAAQ,QAAQ,MAAM;AAC/B,SAASC,SAAS,QAAQ,YAAY;AACtC;;AAGA;AACA;AACA;;AAEA,MAAAC,WAAA,GAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,cAAc,EAAE,KAAK;MACrBC,QAAQ,EAAE,IAAI;MACdC,KAAK,EAAEN,QAAQ,CAAC,CAAC;MACjBO,MAAM,EAAEN,SAAS,CAAC,CAAC;MACnBO,mBAAmB,EAAE,KAAK;MAC1BC,WAAW,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MACjC;MACA;MACAC,qBAAqB,EAAE,CAAC;MACxBC,oBAAoB,EAAE;IACxB,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,aAAa,CAAC,CAAC;IACpB,IAAI,CAACC,qBAAqB,CAAC,CAAC;IAC5B,IAAI,CAACC,8BAA8B,CAAC,CAAC;EACvC,CAAC;EACDC,QAAQ,EAAE;IACRC,MAAMA,CAAA,EAAG;MACP,OAAO,IAAI,CAACd,QAAQ,KAAK,MAAM;IACjC,CAAC;IACDe,UAAUA,CAAA,EAAG;MACX,OAAO,IAAI,CAACf,QAAQ,KAAK,UAAU;IACrC,CAAC;IACDgB,gBAAgBA,CAAA,EAAG;MACjB,OAAO,IAAI,CAAChB,QAAQ,KAAK,QAAQ;IACnC;EACF,CAAC;EAECU,aAAaA,CAAA,EAAG;IACdnB,IAAI,CAAC0B,kBAAkB,CAAEC,IAAI,IAAK;MAChC,MAAMC,OAAO,GAAG1B,GAAG,CAACD,QAAQ,EAAG,SAAQ0B,IAAI,CAACE,GAAI,OAAM,CAAC;MACvD1B,GAAG,CAACyB,OAAO,CAAC,CACTE,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAI,CAACtB,QAAQ,GAAGsB,QAAQ,CAACC,GAAG,CAAC,CAAC;QAC9B;MACF,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;QAChBC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACnD,CAAC,CAAC;IACN,CAAC,CAAC;EACJ,CAAC;EACD,MAAME,OAAOA,CAAA,EAAG;IACd,MAAM,IAAI,CAAC1B,KAAK,CAAC2B,QAAQ,CAAC,YAAY,CAAC;IACvC,IAAI,CAAC1B,MAAM,CAAC2B,IAAI,CAAC,GAAG,CAAC;EACvB;AACF,CAAC;;;;;;;IAvQHH,OAAO,CAACI,GAAG,CAACxC,eAAe,CAAC,CAAC,CAAC;;IAE9B"},"metadata":{},"sourceType":"module","externalDependencies":[]}