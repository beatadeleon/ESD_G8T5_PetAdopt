{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { useRouter } from 'vue-router';\nimport { auth, database } from './firebaseConfig';\nimport { ref, get } from 'firebase/database';\nexport default {\n  __name: 'home',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const fetchUserRole = () => {\n      auth.onAuthStateChanged(user => {\n        if (user) {\n          const userRef = ref(database, `users/${user.uid}/role`);\n          get(userRef).then(snapshot => {\n            const userRole = snapshot.val(); // Use a local variable\n            if (userRole) {\n              // Assign the userRole to the template variable\n              isUser.value = userRole === 'user';\n              isAdmin.value = userRole === 'admin';\n            }\n          }).catch(error => {\n            console.error(\"Error fetching user role:\", error);\n          });\n        } else {\n          // If user is not authenticated, redirect to the login page\n          router.push('/auth/login');\n        }\n      });\n    };\n\n    // Initialize the reactive variables\n    const isUser = ref(false);\n    const isAdmin = ref(false);\n    fetchUserRole();\n    const __returned__ = {\n      router,\n      fetchUserRole,\n      isUser,\n      isAdmin,\n      get useRouter() {\n        return useRouter;\n      },\n      get auth() {\n        return auth;\n      },\n      get database() {\n        return database;\n      },\n      get ref() {\n        return ref;\n      },\n      get get() {\n        return get;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useRouter","auth","database","ref","get","router","fetchUserRole","onAuthStateChanged","user","userRef","uid","then","snapshot","userRole","val","isUser","value","isAdmin","catch","error","console","push"],"sources":["/Users/junyi/Documents/petadopt/src/home.vue"],"sourcesContent":["<script setup>\nimport { useRouter } from 'vue-router'\nimport { auth, database } from './firebaseConfig';\nimport { ref, get } from 'firebase/database';\n\nconst router = useRouter()\n\nconst fetchUserRole = () => {\n    auth.onAuthStateChanged((user) => {\n        if (user) {\n            const userRef = ref(database, `users/${user.uid}/role`);\n            get(userRef)\n                .then((snapshot) => {\n                    const userRole = snapshot.val(); // Use a local variable\n                    if (userRole) {\n                        // Assign the userRole to the template variable\n                        isUser.value = userRole === 'user';\n                        isAdmin.value = userRole === 'admin';\n                    }\n                })\n                .catch((error) => {\n                    console.error(\"Error fetching user role:\", error);\n                });\n        } else {\n            // If user is not authenticated, redirect to the login page\n            router.push('/auth/login');\n        }\n    });\n}\n\n// Initialize the reactive variables\nconst isUser = ref(false);\nconst isAdmin = ref(false);\n\nfetchUserRole();\n</script>\n\n<template>\n  <div>\n    <h1>Welcome to PetAdopt</h1>\n    <p v-if=\"isUser\">\n      Adopt a pet today!\n      <router-link to=\"/dashboard\">\n        <button>Login</button>\n      </router-link>\n    </p>\n    <router-link v-else to=\"/auth/login\">\n      <button>Go to Dashboard</button>\n    </router-link>\n  </div>\n</template>\n\n\n"],"mappings":";AACA,SAASA,SAAS,QAAQ,YAAY;AACtC,SAASC,IAAI,EAAEC,QAAQ,QAAQ,kBAAkB;AACjD,SAASC,GAAG,EAAEC,GAAG,QAAQ,mBAAmB;;;;;;;IAE5C,MAAMC,MAAM,GAAGL,SAAS,CAAC,CAAC;IAE1B,MAAMM,aAAa,GAAGA,CAAA,KAAM;MACxBL,IAAI,CAACM,kBAAkB,CAAEC,IAAI,IAAK;QAC9B,IAAIA,IAAI,EAAE;UACN,MAAMC,OAAO,GAAGN,GAAG,CAACD,QAAQ,EAAG,SAAQM,IAAI,CAACE,GAAI,OAAM,CAAC;UACvDN,GAAG,CAACK,OAAO,CAAC,CACPE,IAAI,CAAEC,QAAQ,IAAK;YAChB,MAAMC,QAAQ,GAAGD,QAAQ,CAACE,GAAG,CAAC,CAAC,CAAC,CAAC;YACjC,IAAID,QAAQ,EAAE;cACV;cACAE,MAAM,CAACC,KAAK,GAAGH,QAAQ,KAAK,MAAM;cAClCI,OAAO,CAACD,KAAK,GAAGH,QAAQ,KAAK,OAAO;YACxC;UACJ,CAAC,CAAC,CACDK,KAAK,CAAEC,KAAK,IAAK;YACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;UACrD,CAAC,CAAC;QACV,CAAC,MAAM;UACH;UACAd,MAAM,CAACgB,IAAI,CAAC,aAAa,CAAC;QAC9B;MACJ,CAAC,CAAC;IACN,CAAC;;IAED;IACA,MAAMN,MAAM,GAAGZ,GAAG,CAAC,KAAK,CAAC;IACzB,MAAMc,OAAO,GAAGd,GAAG,CAAC,KAAK,CAAC;IAE1BG,aAAa,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}